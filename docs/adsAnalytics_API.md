# API –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è: –ê–Ω–∞–ª–∏—Ç–∏–∫–∞ —Ä–µ–∫–ª–∞–º–Ω—ã—Ö –∫–∞–º–ø–∞–Ω–∏–π (–ê–Ω–∞–ª–∏—Ç–∏–∫–∞ –†–ö)

## –û–±–∑–æ—Ä

–ú–æ–¥—É–ª—å `reports/adsAnalytics.gs` –æ—Ç–≤–µ—á–∞–µ—Ç –∑–∞ –≤—ã–≥—Ä—É–∑–∫—É –¥–∞–Ω–Ω—ã—Ö –ø–æ —Ä–µ–∫–ª–∞–º–Ω—ã–º –∫–∞–º–ø–∞–Ω–∏—è–º Wildberries.

**–û—Å–Ω–æ–≤–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏:**
1. –ü–æ–ª—É—á–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ –∞–∫—Ç–∏–≤–Ω—ã—Ö —Ä–µ–∫–ª–∞–º–Ω—ã—Ö –∫–∞–º–ø–∞–Ω–∏–π
2. –ü–æ–ª—É—á–µ–Ω–∏–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –ø–æ –∫–∞–∂–¥–æ–π –∫–∞–º–ø–∞–Ω–∏–∏ –∑–∞ –ø—Ä–µ–¥—ã–¥—É—â–∏–π –¥–µ–Ω—å
3. –î–æ–∑–∞–ø–∏—Å—å –¥–∞–Ω–Ω—ã—Ö –≤ Google Sheets —Å –ø—Ä–æ–≤–µ—Ä–∫–æ–π –¥—É–±–ª–∏–∫–∞—Ç–æ–≤

## –ò—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ API Wildberries

### 1. –ü–æ–ª—É—á–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ –∫–∞–º–ø–∞–Ω–∏–π

**Endpoint:** `GET https://advert-api.wildberries.ru/api/advert/v2/adverts`

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã –∑–∞–ø—Ä–æ—Å–∞:**
- `ids` (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) - ID –∫–∞–º–ø–∞–Ω–∏–π —á–µ—Ä–µ–∑ –∑–∞–ø—è—Ç—É—é, –º–∞–∫—Å–∏–º—É–º 50
- `statuses` (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) - –°—Ç–∞—Ç—É—Å—ã –∫–∞–º–ø–∞–Ω–∏–π —á–µ—Ä–µ–∑ –∑–∞–ø—è—Ç—É—é
- `payment_type` (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) - –¢–∏–ø –æ–ø–ª–∞—Ç—ã: `cpm` –∏–ª–∏ `cpc`

**–°—Ç–∞—Ç—É—Å—ã –∫–∞–º–ø–∞–Ω–∏–π:**
- `-1` ‚Äî —É–¥–∞–ª–µ–Ω–∞ (–ø—Ä–æ—Ü–µ—Å—Å —É–¥–∞–ª–µ–Ω–∏—è –∑–∞–≤–µ—Ä—à–∏—Ç—Å—è –≤ —Ç–µ—á–µ–Ω–∏–µ 10 –º–∏–Ω—É—Ç)
- `4` ‚Äî –≥–æ—Ç–æ–≤–∞ –∫ –∑–∞–ø—É—Å–∫—É
- `7` ‚Äî –∑–∞–≤–µ—Ä—à–µ–Ω–∞
- `8` ‚Äî –æ—Ç–º–µ–Ω–µ–Ω–∞
- `9` ‚Äî –∞–∫—Ç–∏–≤–Ω–∞
- `11` ‚Äî –Ω–∞ –ø–∞—É–∑–µ

**–ò—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ –≤ —Å–∫—Ä–∏–ø—Ç–µ —Å—Ç–∞—Ç—É—Å—ã:** `7, 9, 11`

**–õ–∏–º–∏—Ç—ã:**
- 5 –∑–∞–ø—Ä–æ—Å–æ–≤ –≤ —Å–µ–∫—É–Ω–¥—É
- –ò–Ω—Ç–µ—Ä–≤–∞–ª: 200 –º–∏–ª–ª–∏—Å–µ–∫—É–Ω–¥
- –í—Å–ø–ª–µ—Å–∫: 5 –∑–∞–ø—Ä–æ—Å–æ–≤

**–ü—Ä–∏–º–µ—Ä –æ—Ç–≤–µ—Ç–∞:**
```json
{
  "adverts": [
    {
      "id": 12345,
      "bid_type": "unified",
      "status": 9,
      "timestamps": {
        "createdAt": "2025-01-01T10:00:00Z",
        "updatedAt": "2025-01-14T15:30:00Z"
      },
      "settings": {
        "name": "–ö–∞–º–ø–∞–Ω–∏—è 1",
        "payment_type": "cpm",
        "placements": {
          "recommendations": true,
          "search": true
        }
      },
      "nm_settings": [
        {
          "nm_id": 111850705,
          "subject": {
            "id": 168,
            "name": "–ö—É—Ä—Ç–∫–∏"
          },
          "bids_kopecks": {
            "search": 0,
            "recommendations": 0
          }
        }
      ]
    }
  ]
}
```

**–í–∞–∂–Ω–æ:** –ù–∞–∑–≤–∞–Ω–∏–µ –∫–∞–º–ø–∞–Ω–∏–∏ –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤ `settings.name`, –∞ —Ç–∏–ø –æ–ø–ª–∞—Ç—ã –≤ `settings.payment_type`.

### 2. –ü–æ–ª—É—á–µ–Ω–∏–µ –ø–æ–ª–Ω–æ–π —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –∫–∞–º–ø–∞–Ω–∏–π

**Endpoint:** `GET https://advert-api.wildberries.ru/adv/v3/fullstats`

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã –∑–∞–ø—Ä–æ—Å–∞ (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ):**
- `ids` - ID –∫–∞–º–ø–∞–Ω–∏–π —á–µ—Ä–µ–∑ –∑–∞–ø—è—Ç—É—é, –º–∞–∫—Å–∏–º—É–º 50
- `beginDate` - –î–∞—Ç–∞ –Ω–∞—á–∞–ª–∞ –∏–Ω—Ç–µ—Ä–≤–∞–ª–∞ (—Ñ–æ—Ä–º–∞—Ç: YYYY-MM-DD)
- `endDate` - –î–∞—Ç–∞ –æ–∫–æ–Ω—á–∞–Ω–∏—è –∏–Ω—Ç–µ—Ä–≤–∞–ª–∞ (—Ñ–æ—Ä–º–∞—Ç: YYYY-MM-DD)

**–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è:**
- –ú–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π –ø–µ—Ä–∏–æ–¥ –≤ –∑–∞–ø—Ä–æ—Å–µ: 31 –¥–µ–Ω—å
- –¢–æ–ª—å–∫–æ –¥–ª—è –∫–∞–º–ø–∞–Ω–∏–π –≤ —Å—Ç–∞—Ç—É—Å–∞—Ö 7, 9 –∏ 11

**–õ–∏–º–∏—Ç—ã:**
- 3 –∑–∞–ø—Ä–æ—Å–∞ –≤ –º–∏–Ω—É—Ç—É
- –ò–Ω—Ç–µ—Ä–≤–∞–ª: 20 —Å–µ–∫—É–Ω–¥
- –í—Å–ø–ª–µ—Å–∫: 1 –∑–∞–ø—Ä–æ—Å

**–ü—Ä–∏–º–µ—Ä –æ—Ç–≤–µ—Ç–∞:**
```json
[
  {
    "advertId": 12345,
    "views": 15000,
    "clicks": 300,
    "ctr": 2.0,
    "cpc": 15.5,
    "sum": 4650.0,
    "atbs": 50,
    "orders": 25,
    "cr": 8.33,
    "shks": 30,
    "sum_price": 75000.0,
    "canceled": 2,
    "days": [ ... ],
    "boosterStats": [ ... ]
  }
]
```

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∞–Ω–Ω—ã—Ö –≤ Google Sheets

–õ–∏—Å—Ç: **"–ê–Ω–∞–ª–∏—Ç–∏–∫–∞ –†–ö"**

| –°—Ç–æ–ª–±–µ—Ü | –ù–∞–∑–≤–∞–Ω–∏–µ | –¢–∏–ø | –û–ø–∏—Å–∞–Ω–∏–µ |
|---------|----------|-----|----------|
| A | –î–∞—Ç–∞ –≤—ã–≥—Ä—É–∑–∫–∏ | –î–∞—Ç–∞ | –î–∞—Ç–∞ –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –∫–∞–º–ø–∞–Ω–∏–∏ (–∏–∑ timestamps.updatedAt) |
| B | –¢–∏–ø –†–ö | –¢–µ–∫—Å—Ç | –¢–∏–ø —Å—Ç–∞–≤–∫–∏: `unified` (–µ–¥–∏–Ω–∞—è) –∏–ª–∏ `manual` (—Ä—É—á–Ω–∞—è) |
| C | ID –†–ö | –ß–∏—Å–ª–æ | –£–Ω–∏–∫–∞–ª—å–Ω—ã–π –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –∫–∞–º–ø–∞–Ω–∏–∏ |
| D | –ù–∞–∑–≤–∞–Ω–∏–µ | –¢–µ–∫—Å—Ç | –ù–∞–∑–≤–∞–Ω–∏–µ —Ä–µ–∫–ª–∞–º–Ω–æ–π –∫–∞–º–ø–∞–Ω–∏–∏ |
| E | –°—Ç–∞—Ç—É—Å | –ß–∏—Å–ª–æ | –°—Ç–∞—Ç—É—Å –∫–∞–º–ø–∞–Ω–∏–∏ (7, 9 –∏–ª–∏ 11) |
| F | –¢–∏–ø –æ–ø–ª–∞—Ç—ã | –¢–µ–∫—Å—Ç | –¢–∏–ø –æ–ø–ª–∞—Ç—ã: `cpm` (–∑–∞ –ø–æ–∫–∞–∑—ã) –∏–ª–∏ `cpc` (–∑–∞ –∫–ª–∏–∫) |
| G | –ü–µ—Ä–∏–æ–¥ –Ω–∞—á–∞–ª–æ | –î–∞—Ç–∞ | –î–∞—Ç–∞ –Ω–∞—á–∞–ª–∞ –ø–µ—Ä–∏–æ–¥–∞ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ (–ø—Ä–µ–¥—ã–¥—É—â–∏–π –¥–µ–Ω—å) |
| H | –ü–µ—Ä–∏–æ–¥ –∫–æ–Ω–µ—Ü | –î–∞—Ç–∞ | –î–∞—Ç–∞ –∫–æ–Ω—Ü–∞ –ø–µ—Ä–∏–æ–¥–∞ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ (–ø—Ä–µ–¥—ã–¥—É—â–∏–π –¥–µ–Ω—å) |
| I | –ü–æ–∫–∞–∑—ã | –ß–∏—Å–ª–æ | –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–∫–∞–∑–æ–≤ |
| J | –ö–ª–∏–∫–∏ | –ß–∏—Å–ª–æ | –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∫–ª–∏–∫–æ–≤ |
| K | CTR | –ß–∏—Å–ª–æ | Click-through rate (–æ—Ç–Ω–æ—à–µ–Ω–∏–µ –∫–ª–∏–∫–æ–≤ –∫ –ø–æ–∫–∞–∑–∞–º, %) |
| L | CPC | –ß–∏—Å–ª–æ | –°—Ä–µ–¥–Ω—è—è —Å—Ç–æ–∏–º–æ—Å—Ç—å –∫–ª–∏–∫–∞, ‚ÇΩ |
| M | –ó–∞—Ç—Ä–∞—Ç—ã | –ß–∏—Å–ª–æ | –ó–∞—Ç—Ä–∞—Ç—ã –Ω–∞ —Ä–µ–∫–ª–∞–º—É, ‚ÇΩ |
| N | –î–æ–±–∞–≤–ª–µ–Ω–∏—è –≤ –∫–æ—Ä–∑–∏–Ω—É | –ß–∏—Å–ª–æ | –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –¥–æ–±–∞–≤–ª–µ–Ω–∏–π —Ç–æ–≤–∞—Ä–æ–≤ –≤ –∫–æ—Ä–∑–∏–Ω—É |
| O | –ó–∞–∫–∞–∑—ã | –ß–∏—Å–ª–æ | –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–∫–∞–∑–æ–≤ |
| P | CR | –ß–∏—Å–ª–æ | Conversion rate (–æ—Ç–Ω–æ—à–µ–Ω–∏–µ –∑–∞–∫–∞–∑–æ–≤ –∫ –∫–ª–∏–∫–∞–º, %) |
| Q | –ó–∞–∫–∞–∑–∞–Ω–æ —Ç–æ–≤–∞—Ä–æ–≤ —à—Ç | –ß–∏—Å–ª–æ | –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–∫–∞–∑–∞–Ω–Ω—ã—Ö —Ç–æ–≤–∞—Ä–æ–≤ |
| R | –°—É–º–º–∞ –∑–∞–∫–∞–∑–æ–≤ | –ß–∏—Å–ª–æ | –°—É–º–º–∞ –∑–∞–∫–∞–∑–æ–≤, ‚ÇΩ |
| S | –û—Ç–º–µ–Ω—ã | –ß–∏—Å–ª–æ | –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ—Ç–º–µ–Ω–µ–Ω–Ω—ã—Ö –∑–∞–∫–∞–∑–æ–≤ |

## –û—Å–Ω–æ–≤–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏

### `syncAdsAnalytics()`

–ì–ª–∞–≤–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ –∞–Ω–∞–ª–∏—Ç–∏–∫–∏ –†–ö.

**–ê–ª–≥–æ—Ä–∏—Ç–º —Ä–∞–±–æ—Ç—ã:**
1. –û–ø—Ä–µ–¥–µ–ª—è–µ—Ç –¥–∞—Ç—É –ø—Ä–µ–¥—ã–¥—É—â–µ–≥–æ –¥–Ω—è
2. –ü–æ–ª—É—á–∞–µ—Ç –∏–ª–∏ —Å–æ–∑–¥–∞–µ—Ç –ª–∏—Å—Ç "–ê–Ω–∞–ª–∏—Ç–∏–∫–∞ –†–ö"
3. –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç –∑–∞–≥–æ–ª–æ–≤–∫–∏ (–µ—Å–ª–∏ –ª–∏—Å—Ç –ø—É—Å—Ç–æ–π)
4. –ü–æ–ª—É—á–∞–µ—Ç —Å–ø–∏—Å–æ–∫ –∫–∞–º–ø–∞–Ω–∏–π —Å–æ —Å—Ç–∞—Ç—É—Å–∞–º–∏ 7, 9, 11
5. –§–∏–ª—å—Ç—Ä—É–µ—Ç –∫–∞–º–ø–∞–Ω–∏–∏, –¥–ª—è –∫–æ—Ç–æ—Ä—ã—Ö —É–∂–µ –µ—Å—Ç—å –¥–∞–Ω–Ω—ã–µ –∑–∞ —ç—Ç—É –¥–∞—Ç—É
6. –ü–æ–ª—É—á–∞–µ—Ç —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –ø–æ –∫–∞–º–ø–∞–Ω–∏—è–º –±–∞—Ç—á–∞–º–∏ –ø–æ 50 (—Å –∑–∞–¥–µ—Ä–∂–∫–æ–π 20 —Å–µ–∫ –º–µ–∂–¥—É –±–∞—Ç—á–∞–º–∏)
7. –§–æ—Ä–º–∏—Ä—É–µ—Ç –¥–∞–Ω–Ω—ã–µ –¥–ª—è –∑–∞–ø–∏—Å–∏, –æ–±—ä–µ–¥–∏–Ω—è—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –∫–∞–º–ø–∞–Ω–∏–∏ –∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É
8. –î–æ–∑–∞–ø–∏—Å—ã–≤–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ –≤ —Ç–∞–±–ª–∏—Ü—É

**–ü—Ä–æ–≤–µ—Ä–∫–∞ –¥—É–±–ª–∏–∫–∞—Ç–æ–≤:**
- –ö–æ–º–±–∏–Ω–∞—Ü–∏—è: `ID –†–ö` + `–ü–µ—Ä–∏–æ–¥ –Ω–∞—á–∞–ª–æ`
- –ï—Å–ª–∏ –∑–∞–ø–∏—Å—å —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç, –∫–∞–º–ø–∞–Ω–∏—è –ø—Ä–æ–ø—É—Å–∫–∞–µ—Ç—Å—è

**–û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫:**
- –û—à–∏–±–∫–∏ API –ª–æ–≥–∏—Ä—É—é—Ç—Å—è
- –ü—Ä–∏ –æ—à–∏–±–∫–µ –ø–æ–ª—É—á–µ–Ω–∏—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –¥–ª—è –±–∞—Ç—á–∞, –æ–±—Ä–∞–±–æ—Ç–∫–∞ –ø—Ä–æ–¥–æ–ª–∂–∞–µ—Ç—Å—è –¥–ª—è —Å–ª–µ–¥—É—é—â–µ–≥–æ –±–∞—Ç—á–∞
- –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –æ—à–∏–±–∫–∏ –ø—Ä–µ—Ä—ã–≤–∞—é—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ

### `getAdsAnalyticsHeaders()`

–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –º–∞—Å—Å–∏–≤ –∑–∞–≥–æ–ª–æ–≤–∫–æ–≤ —Å—Ç–æ–ª–±—Ü–æ–≤ –¥–ª—è –ª–∏—Å—Ç–∞ "–ê–Ω–∞–ª–∏—Ç–∏–∫–∞ –†–ö".

**–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç:** `Array<string>`

### `campaignAndDateExistInSheet(sheet, campaignId, dateStr)`

–ü—Ä–æ–≤–µ—Ä—è–µ—Ç, —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –ª–∏ –∑–∞–ø–∏—Å—å –¥–ª—è –¥–∞–Ω–Ω–æ–π –∫–∞–º–ø–∞–Ω–∏–∏ –∏ –¥–∞—Ç—ã –≤ –ª–∏—Å—Ç–µ.

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
- `sheet` (Sheet) - –æ–±—ä–µ–∫—Ç –ª–∏—Å—Ç–∞ Google Sheets
- `campaignId` (number) - ID —Ä–µ–∫–ª–∞–º–Ω–æ–π –∫–∞–º–ø–∞–Ω–∏–∏
- `dateStr` (string) - –¥–∞—Ç–∞ –≤ —Ñ–æ—Ä–º–∞—Ç–µ YYYY-MM-DD

**–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç:** `boolean` - true, –µ—Å–ª–∏ –∑–∞–ø–∏—Å—å —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç

## –§—É–Ω–∫—Ü–∏–∏ –≤ wbApi.gs

### `getAdverts(options)`

–ü–æ–ª—É—á–∞–µ—Ç —Å–ø–∏—Å–æ–∫ —Ä–µ–∫–ª–∞–º–Ω—ã—Ö –∫–∞–º–ø–∞–Ω–∏–π —á–µ—Ä–µ–∑ API Wildberries.

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
- `options` (Object) - –æ–ø—Ü–∏–∏ –∑–∞–ø—Ä–æ—Å–∞
  - `options.ids` (string) - ID –∫–∞–º–ø–∞–Ω–∏–π —á–µ—Ä–µ–∑ –∑–∞–ø—è—Ç—É—é (–º–∞–∫—Å. 50)
  - `options.statuses` (string) - —Å—Ç–∞—Ç—É—Å—ã —á–µ—Ä–µ–∑ –∑–∞–ø—è—Ç—É—é
  - `options.payment_type` (string) - —Ç–∏–ø –æ–ø–ª–∞—Ç—ã: `cpm` –∏–ª–∏ `cpc`

**–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç:** `Array<Object>` - –º–∞—Å—Å–∏–≤ –æ–±—ä–µ–∫—Ç–æ–≤ –∫–∞–º–ø–∞–Ω–∏–π

**–ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è:**
```javascript
var campaigns = getAdverts({
  statuses: '7,9,11'
});
```

### `getAdvertFullStats(advertIds, beginDate, endDate)`

–ü–æ–ª—É—á–∞–µ—Ç –ø–æ–ª–Ω—É—é —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –ø–æ —Ä–µ–∫–ª–∞–º–Ω—ã–º –∫–∞–º–ø–∞–Ω–∏—è–º.

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
- `advertIds` (Array<number>) - –º–∞—Å—Å–∏–≤ ID –∫–∞–º–ø–∞–Ω–∏–π (–º–∞–∫—Å. 50)
- `beginDate` (string) - –¥–∞—Ç–∞ –Ω–∞—á–∞–ª–∞ –≤ —Ñ–æ—Ä–º–∞—Ç–µ YYYY-MM-DD
- `endDate` (string) - –¥–∞—Ç–∞ –∫–æ–Ω—Ü–∞ –≤ —Ñ–æ—Ä–º–∞—Ç–µ YYYY-MM-DD

**–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç:** `Array<Object>` - –º–∞—Å—Å–∏–≤ –æ–±—ä–µ–∫—Ç–æ–≤ —Å–æ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–æ–π

**–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è:**
- –ú–∞–∫—Å–∏–º—É–º 50 ID –∑–∞ –∑–∞–ø—Ä–æ—Å
- –ï—Å–ª–∏ –ø–µ—Ä–µ–¥–∞–Ω–æ –±–æ–ª—å—à–µ, –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç—Å—è —Ç–æ–ª—å–∫–æ –ø–µ—Ä–≤—ã–µ 50

**–ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è:**
```javascript
var stats = getAdvertFullStats([12345, 23456], '2025-01-14', '2025-01-14');
```

## –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Ç—Ä–∏–≥–≥–µ—Ä–∞

–î–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –µ–∂–µ–¥–Ω–µ–≤–Ω–æ–π –≤—ã–≥—Ä—É–∑–∫–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ —Å–æ–∑–¥–∞—Ç—å —Ç—Ä–∏–≥–≥–µ—Ä:

1. –û—Ç–∫—Ä–æ–π—Ç–µ —Ä–µ–¥–∞–∫—Ç–æ—Ä —Å–∫—Ä–∏–ø—Ç–æ–≤
2. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ "–¢—Ä–∏–≥–≥–µ—Ä—ã" (–∏–∫–æ–Ω–∫–∞ –±—É–¥–∏–ª—å–Ω–∏–∫–∞ —Å–ª–µ–≤–∞)
3. –ù–∞–∂–º–∏—Ç–µ "+ –î–æ–±–∞–≤–∏—Ç—å —Ç—Ä–∏–≥–≥–µ—Ä"
4. –ù–∞—Å—Ç—Ä–æ–π—Ç–µ:
   - –§—É–Ω–∫—Ü–∏—è: `syncAdsAnalytics`
   - –ò—Å—Ç–æ—á–Ω–∏–∫ —Å–æ–±—ã—Ç–∏—è: –ü–æ –≤—Ä–µ–º–µ–Ω–∏
   - –¢–∏–ø —Ç—Ä–∏–≥–≥–µ—Ä–∞ –Ω–∞ –æ—Å–Ω–æ–≤–µ –≤—Ä–µ–º–µ–Ω–∏: –¢–∞–π–º–µ—Ä –ø–æ –¥–Ω—è–º
   - –í—Ä–µ–º—è —Å—É—Ç–æ–∫: 01:00 - 02:00 (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –≤—ã–ø–æ–ª–Ω—è—Ç—å –Ω–æ—á—å—é)

## –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π API

### –õ–∏–º–∏—Ç—ã –∑–∞–ø—Ä–æ—Å–æ–≤

1. **getAdverts** (—Å–ø–∏—Å–æ–∫ –∫–∞–º–ø–∞–Ω–∏–π):
   - 5 –∑–∞–ø—Ä–æ—Å–æ–≤ –≤ —Å–µ–∫—É–Ω–¥—É
   - –°–∫—Ä–∏–ø—Ç –≤—ã–ø–æ–ª–Ω—è–µ—Ç 1 –∑–∞–ø—Ä–æ—Å –∑–∞ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—é

2. **getAdvertFullStats** (—Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞):
   - 3 –∑–∞–ø—Ä–æ—Å–∞ –≤ –º–∏–Ω—É—Ç—É
   - –°–∫—Ä–∏–ø—Ç –¥–æ–±–∞–≤–ª—è–µ—Ç –∑–∞–¥–µ—Ä–∂–∫—É 20 —Å–µ–∫—É–Ω–¥ –º–µ–∂–¥—É –±–∞—Ç—á–∞–º–∏
   - –ë–∞—Ç—á–∏ –ø–æ 50 –∫–∞–º–ø–∞–Ω–∏–π –º–∞–∫—Å–∏–º—É–º

### –°—Ç—Ä–∞—Ç–µ–≥–∏—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –±–æ–ª—å—à–æ–≥–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –∫–∞–º–ø–∞–Ω–∏–π

–ï—Å–ª–∏ —É –≤–∞—Å –±–æ–ª–µ–µ 50 –∞–∫—Ç–∏–≤–Ω—ã—Ö –∫–∞–º–ø–∞–Ω–∏–π:
- –ö–∞–º–ø–∞–Ω–∏–∏ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç—Å—è –±–∞—Ç—á–∞–º–∏ –ø–æ 50 —à—Ç.
- –ú–µ–∂–¥—É –±–∞—Ç—á–∞–º–∏ –∑–∞–¥–µ—Ä–∂–∫–∞ 20 —Å–µ–∫—É–Ω–¥
- –û–±—â–µ–µ –≤—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è: ~20 —Å–µ–∫—É–Ω–¥ √ó (–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∫–∞–º–ø–∞–Ω–∏–π / 50)

**–ü—Ä–∏–º–µ—Ä:** 
- 150 –∫–∞–º–ø–∞–Ω–∏–π = 3 –±–∞—Ç—á–∞ = ~40 —Å–µ–∫—É–Ω–¥ + –≤—Ä–µ–º—è –æ–±—Ä–∞–±–æ—Ç–∫–∏

## –ß–∞—Å—Ç—ã–µ –ø—Ä–æ–±–ª–µ–º—ã –∏ —Ä–µ—à–µ–Ω–∏—è

### –û—à–∏–±–∫–∞: "–ü—Ä–µ–≤—ã—à–µ–Ω –ª–∏–º–∏—Ç –∑–∞–ø—Ä–æ—Å–æ–≤ API"

**–ü—Ä–∏—á–∏–Ω–∞:** –°–ª–∏—à–∫–æ–º —á–∞—Å—Ç—ã–µ –∑–∞–ø—Ä–æ—Å—ã –∫ API —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏

**–†–µ—à–µ–Ω–∏–µ:** –°–∫—Ä–∏–ø—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –¥–æ–±–∞–≤–ª—è–µ—Ç –∑–∞–¥–µ—Ä–∂–∫–∏. –ï—Å–ª–∏ –æ—à–∏–±–∫–∞ –ø–æ–≤—Ç–æ—Ä—è–µ—Ç—Å—è, —É–≤–µ–ª–∏—á—å—Ç–µ –∑–∞–¥–µ—Ä–∂–∫—É –≤ –∫–æ–¥–µ:
```javascript
Utilities.sleep(25000); // –£–≤–µ–ª–∏—á–∏—Ç—å —Å 20000 –¥–æ 25000 (25 —Å–µ–∫—É–Ω–¥)
```

### –û—à–∏–±–∫–∞: "WB_API_TOKEN –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω"

**–ü—Ä–∏—á–∏–Ω–∞:** –ù–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω API —Ç–æ–∫–µ–Ω

**–†–µ—à–µ–Ω–∏–µ:** 
1. –ü–æ–ª—É—á–∏—Ç–µ —Ç–æ–∫–µ–Ω –≤ –ª–∏—á–Ω–æ–º –∫–∞–±–∏–Ω–µ—Ç–µ Wildberries (–ü—Ä–æ—Ñ–∏–ª—å ‚Üí –ù–∞—Å—Ç—Ä–æ–π–∫–∏ ‚Üí –î–æ—Å—Ç—É–ø –∫ API)
2. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –µ–≥–æ —á–µ—Ä–µ–∑ –º–µ–Ω—é —Å–∫—Ä–∏–ø—Ç–∞ "üîß –ù–∞—Å—Ç—Ä–æ–π–∫–∏" ‚Üí "–£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Ç–æ–∫–µ–Ω API"

### –î—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö

**–ü—Ä–∏—á–∏–Ω–∞:** –ö–∞–º–ø–∞–Ω–∏—è –º–æ–≥–ª–∞ –±—ã—Ç—å –æ–±–Ω–æ–≤–ª–µ–Ω–∞ –≤ —Ç–æ—Ç –∂–µ –¥–µ–Ω—å

**–ó–∞—â–∏—Ç–∞:** –°–∫—Ä–∏–ø—Ç –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –∫–æ–º–±–∏–Ω–∞—Ü–∏—é `ID –†–ö` + `–ü–µ—Ä–∏–æ–¥ –Ω–∞—á–∞–ª–æ` –∏ –ø—Ä–æ–ø—É—Å–∫–∞–µ—Ç –¥—É–±–ª–∏–∫–∞—Ç—ã

### –ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö –ø–æ –Ω–µ–∫–æ—Ç–æ—Ä—ã–º –∫–∞–º–ø–∞–Ω–∏—è–º

**–ü—Ä–∏—á–∏–Ω–∞:** 
- –ö–∞–º–ø–∞–Ω–∏—è —Ç–æ–ª—å–∫–æ —á—Ç–æ —Å–æ–∑–¥–∞–Ω–∞
- –£ –∫–∞–º–ø–∞–Ω–∏–∏ –Ω–µ—Ç —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –∑–∞ –ø—Ä–µ–¥—ã–¥—É—â–∏–π –¥–µ–Ω—å
- –û—à–∏–±–∫–∞ API –ø—Ä–∏ –ø–æ–ª—É—á–µ–Ω–∏–∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏

**–†–µ—à–µ–Ω–∏–µ:** 
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å—Ç–∞—Ç—É—Å –∫–∞–º–ø–∞–Ω–∏–∏ –≤ –õ–ö WB
- –ü—Ä–æ—Å–º–æ—Ç—Ä–∏—Ç–µ –ª–æ–≥–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è —Å–∫—Ä–∏–ø—Ç–∞ (Ctrl+Enter –≤ —Ä–µ–¥–∞–∫—Ç–æ—Ä–µ ‚Üí –í—ã–ø–æ–ª–Ω–µ–Ω–∏—è)

## –°–≤—è–∑—å —Å –¥—Ä—É–≥–∏–º–∏ –º–æ–¥—É–ª—è–º–∏

### –ò—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ –º–æ–¥—É–ª–∏:
- `config.gs` - `getAdsAnalyticsSheetName()` –¥–ª—è –∏–º–µ–Ω–∏ –ª–∏—Å—Ç–∞
- `wbApi.gs` - `getAdverts()`, `getAdvertFullStats()` –¥–ª—è API –∑–∞–ø—Ä–æ—Å–æ–≤
- `dateUtils.gs` - `getPreviousDay()` –¥–ª—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –¥–∞—Ç—ã
- `sheets.gs` - —Ñ—É–Ω–∫—Ü–∏–∏ —Ä–∞–±–æ—Ç—ã —Å Google Sheets

### –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤:
- –õ–∏—Å—Ç "–í–æ—Ä–æ–Ω–∫–∞ –æ—Ç—á–µ—Ç" - –¥–ª—è —Ä–∞—Å—á–µ—Ç–∞ –ø–æ–∫–∞–∑–∞—Ç–µ–ª–µ–π –ø–æ —Ä–µ–∫–ª–∞–º–µ
- –õ–∏—Å—Ç "–í–æ—Ä–æ–Ω–∫–∞ –î–∏–Ω–∞–º–∏–∫–∞" - –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ –¥–∏–Ω–∞–º–∏–∫–∏ –ø–æ –∞—Ä—Ç–∏–∫—É–ª–∞–º

## –ü—Ä–∏–º–µ—á–∞–Ω–∏—è

1. **–û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ —Å—Ç–∞—Ç—É—Å—ã:** –°–∫—Ä–∏–ø—Ç —Ä–∞–±–æ—Ç–∞–µ—Ç —Ç–æ–ª—å–∫–æ —Å –∫–∞–º–ø–∞–Ω–∏—è–º–∏ –≤ —Å—Ç–∞—Ç—É—Å–∞—Ö 7, 9, 11
2. **–ï–∂–µ–¥–Ω–µ–≤–Ω–∞—è –≤—ã–≥—Ä—É–∑–∫–∞:** –†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –∑–∞–ø—É—Å–∫–∞—Ç—å —Å–∫—Ä–∏–ø—Ç –µ–∂–µ–¥–Ω–µ–≤–Ω–æ –≤ –Ω–æ—á–Ω–æ–µ –≤—Ä–µ–º—è
3. **–ò—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏–µ –¥–∞–Ω–Ω—ã–µ:** –ü—Ä–∏ –ø–µ—Ä–≤–æ–º –∑–∞–ø—É—Å–∫–µ –±—É–¥—É—Ç –∑–∞–≥—Ä—É–∂–µ–Ω—ã —Ç–æ–ª—å–∫–æ –∫–∞–º–ø–∞–Ω–∏–∏ –∑–∞ –ø—Ä–µ–¥—ã–¥—É—â–∏–π –¥–µ–Ω—å
4. **–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å:** API —Ç–æ–∫–µ–Ω —Ö—Ä–∞–Ω–∏—Ç—Å—è –≤ PropertiesService –∏ –Ω–∏–∫–æ–≥–¥–∞ –Ω–µ –≤—ã–≤–æ–¥–∏—Ç—Å—è –≤ –ª–æ–≥–∏
